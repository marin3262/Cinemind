# '라이벌 매치업' 기능 상세 구현 계획

## 1. 기능 컨셉 및 사용자 가치

### 컨셉
단순히 현재 박스오피스 1위를 나열하는 것을 넘어, **"같은 시기에 출발한 라이벌 영화들은 어떻게 경쟁하고 있는가?"** 라는 스토리텔링을 데이터로 보여주는 기능. '무비 트렌드' 탭의 핵심 킬러 콘텐츠로 기획한다.

**구체적인 모습:**
"지난주, 두 편의 기대작이 동시에 개봉했습니다. 7일이 지난 오늘, 두 영화의 첫 주 성적표와 현재까지의 누적 성적을 공개합니다!"

### 사용자 가치
- **새로운 발견의 재미:** "내가 응원하는 영화가 라이벌을 이겼네?", "이 영화가 초반에는 밀렸지만 뒷심이 좋구나!" 와 같이, 경쟁 서사를 통해 영화 시장을 더 깊이 있고 재미있게 탐색하는 경험을 제공한다.
- **독창적인 정보:** 다른 영화 앱에서는 볼 수 없는, 데이터 기반의 인사이트를 제공하여 CineMind 앱만의 전문성과 차별점을 부각한다.

---

## 2. 상세 구현 계획 (2단계)

### 1단계: 백엔드 API 재설계

새로운 '라이벌 매치업' 데이터를 분석하고 제공하는 전용 API를 신설한다.

1.  **신규 API 엔드포인트 생성:**
    - **주소:** `GET /movies/matchup/weekly-rivals`
    - **위치:** `routers/movies.py` (또는 새로운 `routers/matchup.py`)

2.  **새로운 분석 서비스 로직 구현 (`matchup_service.py` 신설 추천):**
    - **a. 라이벌 선정:**
        - KOBIS '주간 박스오피스' API를 호출하여 '지난주' 날짜 기준으로 TOP 10 목록을 가져온다.
        - 이 중에서 개봉일(`openDt`)이 지난주에 속하는 영화들만 필터링한다.
        - 필터링된 영화 중, 주간 박스오피스 순위가 가장 높은 **2편의 영화**를 '금주의 라이벌'로 최종 선정한다.
    - **b. 7일간의 상세 데이터 수집:**
        - 선정된 두 영화 각각에 대해, KOBIS '일별 박스오피스' API를 **7번 호출**하여, 각 영화의 개봉일로부터 7일 동안의 `audiCnt`(일일 관객 수) 데이터를 모두 수집한다.
    - **c. 핵심 지표 계산:**
        - **개봉 첫 주 관객 수:** 수집한 7일간의 `audiCnt`를 합산한다.
        - **현재까지 누적 관객 수:** 주간 박스오피스 데이터에 있는 `audiAcc` 값을 사용한다.
        - **전일 대비 순위 변동:** 주간 박스오피스 데이터에 있는 `rankInten` 값을 사용한다.
    - **d. 데이터 모델 정의 및 반환:**
        - 위 데이터들을 담을 새로운 `MatchupResponse` Pydantic 모델을 `schemas.py`에 정의한다.
        - 최종적으로 분석된 두 영화의 모든 비교 지표를 `MatchupResponse` 객체에 담아 반환한다.

### 2단계: 프론트엔드 UI/UX 전면 개편

백엔드 API가 준비되면, '트렌드' 탭에 이 데이터를 표시할 전용 UI를 구현한다.

1.  **전용 컴포넌트 신설:**
    - **`MatchupCard.tsx`:** 라이벌 영화 한 편의 정보를 표시할 전용 카드를 만든다. 이 카드에는 포스터, 제목, **"개봉 첫 주 성적"**과 **"현재 누적 성적"**이 명확히 표시된다.
    - **`AudienceShareBar.tsx`:** 기존 컴포넌트를 재활용하거나 개선하여, 두 영화의 '개봉 첫 주 성적'을 기준으로 한 관객 점유율을 시각적으로 보여준다.

2.  **`trends.tsx` 화면 구현:**
    - **a. 데이터 호출 로직 변경:**
        - `useEffect`에서 기존의 박스오피스 관련 API들 대신, 새로 만든 `GET /movies/matchup/weekly-rivals` API를 호출하도록 변경한다.
    - **b. '라이벌 매치업' 섹션 구현:**
        - '트렌드' 탭 최상단에 "금주의 라이벌 매치업" 섹션을 만든다.
        - 좌우에 두 개의 `MatchupCard`를 배치하여 라이벌 구도를 형성한다.
        - 두 카드 사이에 `AudienceShareBar`를 배치하여 초반 흥행 승자를 시각적으로 보여준다.
        - 하단에 "개봉 첫 주, 승자는 OOO!"과 같은 요약 텍스트를 추가하여 재미를 더한다.
    - **c. 기존 박스오피스 목록 유지:**
        - '라이벌 매치업' 섹션과는 별개로, 그 아래에는 현재의 전체 박스오피스 순위(TOP 10 세로 목록)를 계속 표시하여, 사용자가 전체 시장 현황도 파악할 수 있도록 한다.
